{
  "name": "FastAPI Jinja2 Postgres WebApp",
  "image": "mcr.microsoft.com/devcontainers/python:3.13-bookworm",
  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

  "features": {
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {}
  },

  "runArgs": [
    "--add-host=host.docker.internal:host-gateway"
  ],

  "forwardPorts": [8000, 5432],
  "portsAttributes": {
    "8000": { "label": "FastAPI", "onAutoForward": "openBrowser" },
    "5432": { "label": "PostgreSQL" }
  },

  "initializeCommand": "bash \"${localWorkspaceFolder}/.devcontainer/ensure-env.sh\"",
  "postStartCommand": "docker compose -f .devcontainer/docker-compose.yml up -d",
  "postCreateCommand": "bash .devcontainer/init-env.sh && curl -LsSf https://astral.sh/uv/install.sh | sh && ~/.local/bin/uv sync",

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance"
      ]
    }
  }
}
